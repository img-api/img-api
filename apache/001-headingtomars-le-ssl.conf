<IfModule mod_ssl.c>
<VirtualHost *:80>
    ServerName headingtomars.com
    ServerAlias headmars.com
	ServerAdmin webmaster@engineer.blue

    <IfModule mod_rewrite.c>
        RewriteEngine On
    </IfModule>

    Alias /static/MEDIA_FILES/GIF /home/imgapi/IMGAPI_DATA/GIF

    <Directory /app/IMGAPI_DATA/GIF>
        Order allow,deny
        Allow from all
        Require all granted
    </Directory>

	DocumentRoot /app/dist

    <Directory "/app/dist">
        Options FollowSymLinks
        AllowOverride All
        Require all granted

    <IfModule mod_negotiation.c>
        Options -MultiViews
    </IfModule>

    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteBase /
        RewriteRule ^index\.html$ - [L]
        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME} !-d
        RewriteRule . /index.html [L]
    </IfModule>
    </Directory>

    <Files imgapi_launcher.wsgi>
        Order allow,deny
        Allow from all
    </Files>

    <Directory /app/>
        Order allow,deny
        Allow from all
        Require all granted
    </Directory>

#        WSGIPassAuthorization On
#       WSGIDaemonProcess heading_imgapi_launcher user=imgapi group=imgapi threads=256 processes=32 inactivity-timeout=15 python-home=/home/imgapi/img-api/.venv python-path=/home/imgapi/img-api/.venv/lib/python3.11/site-packages

#        WSGIProcessGroup heading_imgapi_launcher
#        WSGIScriptAlias /api /home/imgapi/img-api/imgapi_launcher.wsgi/api
#        WSGIScriptReloading On

    ProxyPass /api http://localhost:8001/api
    ProxyPassReverse /api http://localhost:8001/api

    ProxyPass /admin http://localhost:8001/admin
    ProxyPassReverse /admin http://localhost:8001/admin

    ProxyRequests off
    ProxyPreserveHost On

	ErrorLog ${APACHE_LOG_DIR}/imgapi-https-error.log
	CustomLog ${APACHE_LOG_DIR}/imgapi-https-access.log combined

</VirtualHost>
</IfModule>
